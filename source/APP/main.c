#include "DCBX_Test_CEE.h"
#include "DCBX_Test_IEEE.h"
#include "DCBX_Analyze.h"
#include "mctp.h"
#include "sha256.h"
#include "cJSON.h"
#include "pldm_cjson.h"
#include "pldm_bej_resolve.h"
#include "pldm_redfish.h"
#include "pldm_fw_update.h"
#include "pldm_monitor.h"
#include "pldm_fru_data.h"
#include "pdr.h"
#include "pldm_data.h"
#include "main.h"

FILE *g_fp = NULL;


u8 g_dcbx_intel_pcap_buf[] = { 0x01, 0x80, 0xc2, 0x00, 0x00, 0x0e, 0x00, 0x05, 0x73, 0xf3, 0x4d, 0x4a, 0x81, 0x00, 0xe0, 0x09,        //dcbx-intel.pcap
                0x88, 0xcc, 0x02, 0x07, 0x04, 0x00, 0x05, 0x73, 0xf3, 0x4d, 0x4a, 0x04, 0x07, 0x07, 0x45, 0x74,
                0x68, 0x31, 0x2f, 0x33, 0x06, 0x02, 0x00, 0x78, 0x08, 0x0b, 0x45, 0x74, 0x68, 0x65, 0x72, 0x6e,
                0x65, 0x74, 0x31, 0x2f, 0x33, 0x0a, 0x0c, 0x4e, 0x35, 0x4b, 0x2d, 0x35, 0x2d, 0x4c, 0x61, 0x62,
                0x33, 0x2d, 0x33, 0x0c, 0x95, 0x43, 0x69, 0x73, 0x63, 0x6f, 0x20, 0x4e, 0x65, 0x78, 0x75, 0x73,
                0x20, 0x4f, 0x70, 0x65, 0x72, 0x61, 0x74, 0x69, 0x6e, 0x67, 0x20, 0x53, 0x79, 0x73, 0x74, 0x65,
                0x6d, 0x20, 0x28, 0x4e, 0x58, 0x2d, 0x4f, 0x53, 0x29, 0x20, 0x53, 0x6f, 0x66, 0x74, 0x77, 0x61,
                0x72, 0x65, 0x0a, 0x54, 0x41, 0x43, 0x20, 0x73, 0x75, 0x70, 0x70, 0x6f, 0x72, 0x74, 0x3a, 0x20,
                0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77, 0x2e, 0x63, 0x69, 0x73, 0x63, 0x6f,
                0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x74, 0x61, 0x63, 0x0a, 0x43, 0x6f, 0x70, 0x79, 0x72, 0x69, 0x67,
                0x68, 0x74, 0x20, 0x28, 0x63, 0x29, 0x20, 0x32, 0x30, 0x30, 0x32, 0x2d, 0x32, 0x30, 0x31, 0x32,
                0x2c, 0x20, 0x43, 0x69, 0x73, 0x63, 0x6f, 0x20, 0x53, 0x79, 0x73, 0x74, 0x65, 0x6d, 0x73, 0x2c,
                0x20, 0x49, 0x6e, 0x63, 0x2e, 0x20, 0x41, 0x6c, 0x6c, 0x20, 0x72, 0x69, 0x67, 0x68, 0x74, 0x73,
                0x20, 0x72, 0x65, 0x73, 0x65, 0x72, 0x76, 0x65, 0x64, 0x2e, 0x0e, 0x04, 0x00, 0x04, 0x00, 0x04,
                0x10, 0x0c, 0x05, 0x01, 0xc0, 0xa8, 0x00, 0x3a, 0x02, 0x05, 0x00, 0x00, 0x00, 0x00, 0xfe, 0x37,
                0x00, 0x1b, 0x21, 0x02, 0x02, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01,
                0x06, 0x06, 0x00, 0x00, 0x80, 0x00, 0x08, 0x08, 0x08, 0x0a, 0x00, 0x00, 0x80, 0x00, 0x89, 0x06,
                0x00, 0x1b, 0x21, 0x08, 0x04, 0x11, 0x00, 0x00, 0x80, 0x00, 0x00, 0x01, 0x00, 0x00, 0x32, 0x32,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xfe, 0x05, 0x00, 0x01, 0x42, 0x01, 0x01, 0xfe, 0x14,
                0x00, 0x01, 0x42, 0x02, 0x05, 0xdc, 0x05, 0xdc, 0x05, 0xdc, 0x08, 0x6e, 0x05, 0xdc, 0x05, 0xdc,
                0x05, 0xdc, 0x05, 0xdc, 0xfe, 0x06, 0x00, 0x80, 0xc2, 0x01, 0x00, 0x32, 0x00, 0x00
                };            
u8 g_dcbx_sample_capture_1_pcap_buf[] = { 0x01, 0x80, 0xc2, 0x00, 0x00, 0x0e, 0x84, 0x18, 0x88, 0xd6, 0x39, 0x71, 0x88, 0xcc, 0x02, 0x07,     //dcbx_sample_capture_1.pcap
            0x04, 0x84, 0x18, 0x88, 0xd6, 0x39, 0x48, 0x04, 0x04, 0x07, 0x35, 0x32, 0x36, 0x06, 0x02, 0x00,
            0x28, 0xfe, 0x3d, 0x00, 0x1b, 0x21, 0x02, 0x02, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00,
            0x00, 0x00, 0x03, 0x04, 0x11, 0x00, 0x00, 0x80, 0x00, 0x77, 0x77, 0x77, 0x77, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x64, 0x03, 0x06, 0x06, 0x00, 0x00, 0x80, 0x00, 0x00, 0x08, 0x08, 0x10,
            0x00, 0x00, 0x80, 0x00, 0xc3, 0x51, 0x01, 0x1b, 0x21, 0x02, 0xc3, 0x50, 0x01, 0x1b, 0x21, 0x04,
            0x0c, 0x58, 0x4a, 0x75, 0x6e, 0x69, 0x70, 0x65, 0x72, 0x20, 0x4e, 0x65, 0x74, 0x77, 0x6f, 0x72,
            0x6b, 0x73, 0x2c, 0x20, 0x49, 0x6e, 0x63, 0x2e, 0x20, 0x71, 0x66, 0x78, 0x33, 0x35, 0x30, 0x30,
            0x73, 0x20, 0x2c, 0x20, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x20, 0x31, 0x32, 0x2e, 0x33,
            0x58, 0x35, 0x30, 0x2e, 0x31, 0x20, 0x42, 0x75, 0x69, 0x6c, 0x64, 0x20, 0x64, 0x61, 0x74, 0x65,
            0x3a, 0x20, 0x32, 0x30, 0x31, 0x33, 0x2d, 0x30, 0x33, 0x2d, 0x30, 0x35, 0x20, 0x30, 0x30, 0x3a,
            0x33, 0x32, 0x3a, 0x30, 0x36, 0x20, 0x55, 0x54, 0x43, 0x20, 0x0e, 0x04, 0x00, 0x14, 0x00, 0x14,
            0x08, 0x0b, 0x78, 0x65, 0x2d, 0x30, 0x2f, 0x30, 0x2f, 0x33, 0x38, 0x2e, 0x30, 0xfe, 0x09, 0x00,
            0x12, 0x0f, 0x01, 0x01, 0x6c, 0x1d, 0x00, 0x00, 0xfe, 0x09, 0x00, 0x12, 0x0f, 0x03, 0x01, 0x00,
            0x00, 0x00, 0x00, 0xfe, 0x06, 0x00, 0x12, 0x0f, 0x04, 0x05, 0xea, 0xfe, 0x06, 0x00, 0x80, 0xc2,
            0x01, 0x00, 0x00, 0xfe, 0x0e, 0x00, 0x80, 0xc2, 0x03, 0x00, 0x00, 0x07, 0x64, 0x65, 0x66, 0x61,
            0x75, 0x6c, 0x74, 0x00, 0x00
            };        
u8 g_dcbx_sample_capture_2_pcap_buf[] = { 0x01, 0x80, 0xc2, 0x00, 0x00, 0x0e, 0x00, 0x07, 0x43, 0x10, 0x53, 0xd0, 0x88, 0xcc, 0x02, 0x07,     //dcbx_sample_capture_2.pcap      
                0x04, 0x00, 0x07, 0x43, 0x10, 0x53, 0xd0, 0x04, 0x07, 0x03, 0x00, 0x07, 0x43, 0x10, 0x53, 0xd0,
                0x06, 0x02, 0x00, 0x78, 0xfe, 0x43, 0x00, 0x1b, 0x21, 0x02, 0x02, 0x0a, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x03, 0x00, 0x00, 0x00, 0x02, 0x04, 0x11, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x11, 0x1f,
                0x19, 0x4b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x06, 0x06, 0x00, 0x00, 0xc0, 0x00, 0x08,
                0x08, 0x08, 0x16, 0x00, 0x00, 0xe0, 0x00, 0x89, 0x06, 0x01, 0x1b, 0x21, 0x08, 0x0c, 0xbc, 0x01,
                0x1b, 0x21, 0x08, 0x89, 0x14, 0x00, 0x1b, 0x21, 0x08, 0x00, 0x00
                };  

u8 g_ieee_pcap_buf[] = { 0x01, 0x80, 0xc2, 0x00, 0x00, 0x0e, 0x84, 0x18, 0x88, 0xd6, 0x39, 0x71, 0x88, 0xcc, 0x02, 0x07,           //ieee.pcap
                0x04, 0x84, 0x18, 0x88, 0xd6, 0x39, 0x48, 0x04, 0x04, 0x07, 0x35, 0x32, 0x36, 0x06, 0x02, 0x00,
                0x28, 0xfe, 0x19, 0x00, 0x80, 0xc2, 0x09, 0x03, 0x77, 0x76, 0x77, 0x76, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x64, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0xfe, 0x19, 0x00, 0x80,
                0xc2, 0x0a, 0x03, 0x77, 0x77, 0x77, 0x77, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x64, 0x02,
                0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0xfe, 0x06, 0x00, 0x80, 0xc2, 0x0b, 0x08, 0x00, 0xfe,
                0x0b, 0x00, 0x80, 0xc2, 0x0c, 0x00, 0x24, 0xc3, 0x51, 0x44, 0xc3, 0x50, 0x0c, 0x58, 0x4a, 0x75,
                0x6e, 0x69, 0x70, 0x65, 0x72, 0x20, 0x4e, 0x65, 0x74, 0x77, 0x6f, 0x72, 0x6b, 0x73, 0x2c, 0x20,
                0x49, 0x6e, 0x63, 0x2e, 0x20, 0x71, 0x66, 0x78, 0x33, 0x35, 0x30, 0x30, 0x73, 0x20, 0x2c, 0x20,
                0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 0x20, 0x31, 0x32, 0x2e, 0x33, 0x58, 0x35, 0x30, 0x2e,
                0x31, 0x20, 0x42, 0x75, 0x69, 0x6c, 0x64, 0x20, 0x64, 0x61, 0x74, 0x65, 0x3a, 0x20, 0x32, 0x30,
                0x31, 0x33, 0x2d, 0x30, 0x33, 0x2d, 0x30, 0x35, 0x20, 0x30, 0x30, 0x3a, 0x33, 0x32, 0x3a, 0x30,
                0x36, 0x20, 0x55, 0x54, 0x43, 0x20, 0x0e, 0x04, 0x00, 0x14, 0x00, 0x14, 0x08, 0x0b, 0x78, 0x65,
                0x2d, 0x30, 0x2f, 0x30, 0x2f, 0x33, 0x38, 0x2e, 0x30, 0xfe, 0x09, 0x00, 0x12, 0x0f, 0x01, 0x01,
                0x6c, 0x1d, 0x00, 0x00, 0xfe, 0x09, 0x00, 0x12, 0x0f, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0xfe,
                0x06, 0x00, 0x12, 0x0f, 0x04, 0x05, 0xea, 0xfe, 0x06, 0x00, 0x80, 0xc2, 0x01, 0x00, 0x00, 0xfe,
                0x0e, 0x00, 0x80, 0xc2, 0x03, 0x00, 0x00, 0x07, 0x64, 0x65, 0x66, 0x61, 0x75, 0x6c, 0x74, 0x00,
                0x00
                };

u8 g_sumbus_pkt0x00[] = {                         /* Clear Initial State 0x00 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x40                                        /* pec */
};

u8 g_sumbus_pkt0x01[] = {                      /* select_package 0x01 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x01, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x42                                        /* pec */
};

u8 g_sumbus_pkt0x02[] = {                      /* deselect_package 0x02 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x02, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x44                                        /* pec */
};

u8 g_sumbus_pkt0x03[] = {                      /* enable_channel 0x03 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x03, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x46                                        /* pec */
};

u8 g_sumbus_pkt0x04[] = {                      /* disable_channel 0x04 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x04, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x48                                        /* pec */
};

u8 g_sumbus_pkt0x05[] = {                      /* reset_channel 0x05 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x05, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x4a                                        /* pec */
};

u8 g_sumbus_pkt0x06[] = {                      /* enable_network_tx 0x06 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x06, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x4c                                        /* pec */
};

u8 g_sumbus_pkt0x07[] = {                      /* disable_network_tx 0x07 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x07, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x4e                                        /* pec */
};

u8 g_sumbus_pkt0x08[] = {                      /* enable_aen 0x08 */
    0x92, 0x0f, 0x22, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x08, 0x00, 0x00, 0x08,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0xff,                     /* mc id : 0xff */
    0x00, 0x00, 0x00, 0x07,                     /* bit 0, 1, 2 : 1 */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x31                                        /* pec */
};

u8 g_sumbus_pkt0x09[] = {                      /* set_link 0x09 */
    0x92, 0x0f, 0x22, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x09, 0x00, 0x00, 0x08,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x03, 0xff,                     /* all speed select, auto nego : 1, half-duplex, full-duplex, more detail : dsp0222_1.1.1 table 41 */
    0x00, 0x00, 0x00, 0x00,                     /* OEM Set Link bit definitions */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x86                                        /* pec */
};

u8 g_sumbus_pkt0x0a[] = {                      /* get_link_status 0x0a */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x0a, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x54                                        /* pec */
};

u8 g_sumbus_pkt0x0b[] = {                      /* set_vlan_filter 0x0b */
    0x92, 0x0f, 0x22, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x0b, 0x00, 0x00, 0x08,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0xff,                     /* vlan id 0xff more detail : dsp0222_1.1.1 table 52 */
    0x00, 0x00, 0x01, 0x01,                     /* index = 1, enable */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x39                                        /* pec */
};

u8 g_sumbus_pkt0x0c[] = {                      /* enable_vlan 0x0c */
    0x92, 0x0f, 0x1e, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x0c, 0x00, 0x00, 0x04,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x01,                     /* mode = 1 (vlan only) more detail : dsp0222_1.1.1 table 58 */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0xa5                                        /* pec */
};

u8 g_sumbus_pkt0x0d[] = {                      /* disable_vlan 0x0d */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x0d, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x5a                                        /* pec */
};

u8 g_sumbus_pkt0x0e[] = {                      /* Set MAC Address 0x0e */
    0x92, 0x0f, 0x22, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x0e, 0x00, 0x00, 0x08,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0X25, 0x90, 0x7E,
    0x91, 0xE5, 0x01, 0x01,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x01                                        /* pec */
};

u8 g_sumbus_pkt0x0f[] = {                      /* Set MAC Address 0x0e */
    0x00
};

u8 g_sumbus_pkt0x10[] = {                      /* enable_broadcast_filter 0x10 */
    0x92, 0x0f, 0x1e, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x10, 0x00, 0x00, 0x04,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x0f,                     /* forward all broadcast pkts */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0xee                                        /* pec */
};

u8 g_sumbus_pkt0x11[] = {                      /* disable_broadcast_filter 0x11 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x11, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x62                                        /* pec */
};

u8 g_sumbus_pkt0x12[] = {                      /* enable_global_multicast_filter 0x12 */
    0x92, 0x0f, 0x1e, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x12, 0x00, 0x00, 0x04,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x3f,                     /* forward all multicast pkts */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0xe0                                        /* pec */
};

u8 g_sumbus_pkt0x13[] = {                      /* disable_global_multicast_filter 0x13 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x13, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x66                                        /* pec */
};

u8 g_sumbus_pkt0x14[] = {                      /* set_flow_control 0x14 */
    0x92, 0x0f, 0x1e, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x14, 0x00, 0x00, 0x04,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* disable flow ctrl more detail : dsp0222_1.1.1 table 79 */
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x6e                                        /* pec */
};

u8 g_sumbus_pkt0x15[] = {                      /* get_version_id 0x15 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x15, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x6a                                        /* pec */
};

u8 g_sumbus_pkt0x16[] = {                      /* get_capabilities 0x16 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x16, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x6c                                        /* pec */
};

u8 g_sumbus_pkt0x17[] = {                      /* get_parameters 0x17 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x17, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x6e                                        /* pec */
};

u8 g_sumbus_pkt0x18[] = {                      /* get_controller_statistics 0x18 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x18, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x70                                        /* pec */
};

u8 g_sumbus_pkt0x19[] = {                      /* get_ncsi_statistics 0x19 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x19, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x72                                        /* pec */
};

u8 g_sumbus_pkt0x1a[] = {                      /* get_ncsi_pass_through 0x1a */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x1a, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                     /* checksum */
    0x74                                        /* pec */
};

typedef struct {
    u8 sync_config;
    u8 sync_config_sup;
    u8 event_class_cnt;
    u8 eventclass[0];
} pldm_event_msg_sup_rsp_dat_t;

u8 gs_buf[128] = {244};

u8 gs_sumbus_pkt0[] = {                         /* Clear Initial State 0x00 */
    0x92, 0x0f, 0x1a, 0x21,
    0x01, 0x0A, 0x08, 0xfb,
    0x02,
    0x00, 0x01, 0x00, 0x00,
    0x02, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,                   /* checksum */
    0x40                                        /* pec */
};

extern u8 bej_buf[];
extern u8 dict0[];
extern u8 dict1[];
extern u8 dict_test[];
extern u8 *json_buf;
extern u8 json_test[];
// extern cJSON *cjson_test;

void printf_cjson(cJSON *node)
{
    if (!node) return;
    LOG("name : %s", node->string);
    printf_cjson(node->child);
    printf_cjson(node->next);
}

void my_exit(void)
{
    if (g_fp)
        fclose(g_fp);
    printf("before exit () !\n");
}

int main(int argc, char * argv [])
{
    atexit (my_exit);
    // DCBX_ANALYZE(g_dcbx_sample_capture_2_pcap_buf);
    // pldm_event_msg_sup_rsp_dat_t *aa = (pldm_event_msg_sup_rsp_dat_t *)gs_buf;
    // u32 c = (u32)gs_buf;
    // u32 *a = (u32 *)(c);
    // u8 b[8] = {0};

    // ((u32 *)b)[0] = 0x12345678;
    // u8 pec = crc16_i2c_smbus(0, gs_sumbus_pkt0, gs_sumbus_pkt0[2] + 3);
    // pldm_poll_for_platform_event_msg_rsp_dat_t *a = NULL;
    // LOG("0x%x", pec);
    // LOG("%x", *((u32 *)(&b[0])));
    // DCBX_ANALYZE(g_dcbx_sample_capture_2_pcap_buf);
    // u8 present_state = 10;
    // u8 *a = &present_state;
    // LOG("%d", a[0]);
    // LOG("%d", test());
    // unsigned char in[] = "hello world";
	// unsigned char buff[32];//必须带unsigned ,sha256消息摘要输出为256位,即32字节
	// memset(buff,0,32);
	// puts("start sha256 hash \n");
	// sha256(in,strlen(in),buff);
	// LOG("\nThe sha256 hash is :\n");
    // 	for(int i=0;i<32;i++)
	// {
 
	// 	LOG("%02x",buff[i]);	
	// }
	// puts("\n end sha256 hash \n");
    // rsa_test();
    // u8 xzxz[] = {0x1c, 0x1c, 0x1c, 0x1c};
    // LOG("%x", crc32_pldm(xzxz, 4));
    // u32 notify_buf[] = {
    //     0xa7006003, \
    //     0x00000000, \
    //     0x0092e004, \
    //     0x1000017f, \
    //     0xb41a0000, \
    //     0xc8080001, \
    //     0x000d8000, \
    //     0x00000000
    // };
    // mctp_hdr_t *mctp_hdr = (mctp_hdr_t *)&notify_buf[5];
    // LOG("src_eid : 0x%02x", mctp_hdr->dest_eid);
    // pldm_redfish_dictionary_format_t *dict_ptr = (pldm_redfish_dictionary_format_t *)dict0;
    // for (u8 i = 0; i < dict_ptr->entry_cnt; i++) {
    //     LOG("fmt : 0x%02x", dict_ptr->entry[i].format);
    // }
    // cJSON *fmt_err = NULL;
    // cJSON *dummy = NULL;
    // pldm_bej_init();
    // pldm_cjson_test();
    // LOG("total len : %d", pldm_bej_decode(bej_buf, dict0, &(dict_ptr->entry[0]), dict_ptr->entry_cnt, cjson_test));
    // char *str = cJSON_Print(cjson_test);
    // LOG("%s", str);
    // dummy = cJSON_GetObjectItem(cjson_test, "DummySimple");
    // fmt_err = cJSON_GetObjectItem(dummy, "fmt_err");
    // LOG("%s", fmt_err->valuestring);
    // cJSON_Delete(cjson_test);
    // pldm_bej_encode(json_buf, dict);

    // cJSON *tmp = cJSON_Parse(json_buf);
    // char *str = cJSON_Print(tmp);
    // LOG("%s", str);
    // printf_cjson(tmp);
    // cJSON_Delete(tmp);

    // cJSON *ptr = cJSON_Parse((char *)json_test);
    // char *str = cJSON_Print(ptr);
    // LOG("%s", str);

    // LOG("%08x", ~crc32_pldm(b, len));
    // LOG("%08x", ~0xa4fc415f);
    // for (u8 i = 0; i < 8; i++) {
    //     LOG("%02x ", b[i]);
    // }

    // pldm_cjson_test();

    // pldm_redfish_dict_test();
    // pldm_fwup_verify_pkt_data_test();
    pldm_monitor_test();
    // pldm_fru_data_test();
    // pldm_redfsih_dict_signature_test();
    // pldm_data_analyze();

    // LOG("cmd : 0x00, size : %d", sizeof(g_sumbus_pkt0x00));
    // LOG("cmd : 0x01, size : %d", sizeof(g_sumbus_pkt0x01));
    // LOG("cmd : 0x02, size : %d", sizeof(g_sumbus_pkt0x02));
    // LOG("cmd : 0x03, size : %d", sizeof(g_sumbus_pkt0x03));
    // LOG("cmd : 0x04, size : %d", sizeof(g_sumbus_pkt0x04));
    // LOG("cmd : 0x05, size : %d", sizeof(g_sumbus_pkt0x05));
    // LOG("cmd : 0x06, size : %d", sizeof(g_sumbus_pkt0x06));
    // LOG("cmd : 0x07, size : %d", sizeof(g_sumbus_pkt0x07));
    // LOG("cmd : 0x08, size : %d", sizeof(g_sumbus_pkt0x08));
    // LOG("cmd : 0x09, size : %d", sizeof(g_sumbus_pkt0x09));
    // LOG("cmd : 0x0a, size : %d", sizeof(g_sumbus_pkt0x0a));
    // LOG("cmd : 0x0b, size : %d", sizeof(g_sumbus_pkt0x0b));
    // LOG("cmd : 0x0c, size : %d", sizeof(g_sumbus_pkt0x0c));
    // LOG("cmd : 0x0d, size : %d", sizeof(g_sumbus_pkt0x0d));
    // LOG("cmd : 0x0e, size : %d", sizeof(g_sumbus_pkt0x0e));
    // LOG("cmd : 0x0f, size : %d", sizeof(g_sumbus_pkt0x0f));
    // LOG("cmd : 0x10, size : %d", sizeof(g_sumbus_pkt0x10));
    // LOG("cmd : 0x11, size : %d", sizeof(g_sumbus_pkt0x11));
    // LOG("cmd : 0x12, size : %d", sizeof(g_sumbus_pkt0x12));
    // LOG("cmd : 0x13, size : %d", sizeof(g_sumbus_pkt0x13));
    // LOG("cmd : 0x14, size : %d", sizeof(g_sumbus_pkt0x14));
    // LOG("cmd : 0x15, size : %d", sizeof(g_sumbus_pkt0x15));
    // LOG("cmd : 0x16, size : %d", sizeof(g_sumbus_pkt0x16));
    // LOG("cmd : 0x17, size : %d", sizeof(g_sumbus_pkt0x17));
    // LOG("cmd : 0x18, size : %d", sizeof(g_sumbus_pkt0x18));
    // LOG("cmd : 0x19, size : %d", sizeof(g_sumbus_pkt0x19));
    // LOG("cmd : 0x1a, size : %d", sizeof(g_sumbus_pkt0x1a));
    fclose(g_fp);
	return 0;
}



